##page 6
library(lme4)
cbpp
plot(cbpp$period,cbpp$incidence/cbpp$size,xlab="Period",ylab="Prob of getting CPBB")
# Read in data file
initobs <- read.table("initobs.csv", header = TRUE, sep = ',', na.strings = "na")
initobs
y<-cbind(cbpp$incidence,cbpp$size - cbpp$incidence)
m1<-glmer(y~period+(1|herd),family=binomial,data=cbpp)
summary(m1)
coef(m1)
plot(cbpp$period,cbpp$incidence/cbpp$size,xlab="Period",ylab="Prob of getting CPBB")
plot(initobs$Trt, initobs$Bc/initobs$Steps, xlab="Treatment",ylab="Prob of having weed")
plot(initobs$Trt, initobs$Bc/initobs$Steps, xlab="Treatment",ylab="Prob of having weed")
initobs
# Read in data file
initobs <- read.table("initobs.csv", header = TRUE, sep = ',', na.strings = "na")
hist(initobs$Bc)
pardef <- par()
par(mfrow = c(2,2))
plot(as.factor(initobs$Trt), initobs$Bc/initobs$Steps,
xlab="Treatment",ylab="Prob of having Buttercup")
plot(as.factor(initobs$Farm), initobs$Bc/initobs$Steps,
xlab="Farm", ylab="Prob of having Buttercup")
plot(as.factor(initobs$Plot), initobs$Bc/initobs$Steps,
xlab="Plot", ylab="Prob of having Buttercup")
plot(as.factor(initobs$Observer),initobs$Bc/initobs$Steps,
xlab="Observer", ylab="Prob of having Buttercup")
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer) + (1|Farm) + (1|Plot),
family = binomial, data = initobs)
library(lme4)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer) + (1|Farm) + (1|Plot),
family = binomial, data = initobs)
summary(m1)
par(mfrow=c(1,3))
qqnorm(resid(m1, main = "Residual Plot"))
hist(resid(m1), main = "Histogram of Residuals")
plot(fitted(m1), resid(m1), xlab = "Fitted", ylab="Residuals")
abline(0,0)
par(mfrow=c(3,1))
qqnorm(resid(m1, main = "Residual Plot"))
hist(resid(m1), main = "Histogram of Residuals")
plot(fitted(m1), resid(m1), xlab = "Fitted", ylab="Residuals")
abline(0,0)
qqnorm(resid(m1, main = "Residual Plot"))
par(mfrow=c(1,3))
qqnorm(resid(m1, main = "Residual Plot"))
hist(resid(m1), main = "Histogram of Residuals")
plot(fitted(m1), resid(m1), xlab = "Fitted", ylab="Residuals")
abline(0,0)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
summary(m1)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer),
family = binomial, data = initobs)
summary(m1)
) + (1|Farm)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
summary(m1)
hist(initobs$Bc)
m <- lm(cbind(Bc, NotBc) ~ Trt,
family = binomial, data = initobs)
m <- lm(Bc ~ Trt, data = initobs)
summary(m)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
summary(m1)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt +(1|Farm),
family = binomial, data = initobs)
summary(m1)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer),
family = binomial, data = initobs)
summary(m1)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1|Plot),
family = binomial, data = initobs)
summary(m1)
# Create plots of random effects
re <- ranef(m1)
re
View(re)
par(mfrow=c(1,3))
qqnorm(resid(m1, main = "Residual Plot"))
hist(resid(m1), main = "Histogram of Residuals")
plot(fitted(m1), resid(m1), xlab = "Fitted", ylab="Residuals")
abline(0,0)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
summary(m1)
# Create plots of the residuals
par(mfrow=c(1,3))
qqnorm(resid(m1, main = "Residual Plot"))
hist(resid(m1), main = "Histogram of Residuals")
plot(fitted(m1), resid(m1), xlab = "Fitted", ylab="Residuals")
abline(0,0)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + Plot + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
summary(m1)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
par(mfrow=c(1,3))
qqnorm(resid(m1, main = "Residual Plot"))
abline(0,1)
hist(resid(m1), main = "Histogram of Residuals")
plot(fitted(m1), resid(m1), xlab = "Fitted", ylab="Residuals")
abline(0,0)
boxplot(re, initobs$Observer)
boxplot(as.factor(initobs$Observer), re)
# Create plots of random effects
re <- ranef(m1)$Observer
re
boxplot(re)
boxplot(as.data.frame(re))
# Create plots of random effects
re <- ranef(m1)$Observer
re
# Create plots of random effects
re <- ranef(m1)$Trt
re
m1 <- glmer(cbind(Bc, NotBc) ~ as.Factor(Trt) + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
Trt <- as.factor(initobs$Trt)
m1 <- glmer(cbind(Bc, NotBc) ~ Trt + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
summary(m1)
# Read in data file
initobs <- read.table("initobs.csv", header = TRUE, sep = ',', na.strings = "na")
initobs
plot <- as.factor(initobs$Plot)
trt <- as.factor(initobs$Trt)
m1 <- glmer(cbind(Bc, NotBc) ~ trt + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
summary(m1)
# Create plots of random effects
re <- ranef(m1)$Obserser
re
m1 <- glmer(cbind(Bc, NotBc) ~ trt + (1 |Observer) + (1|Farm),
family = binomial, data = initobs)
summary(m1)
# Create plots of random effects
re <- ranef(m1)$Obserser
re
# Create plots of random effects
re <- ranef(m1)$Observer
re
boxplot(as.factor(initobs$Observer, re))
re <- ranef(m1)$Observer
boxplot(as.factor(initobs$Observer, re))
boxplot(as.factor(initobs$Observer), re)
boxplot(m1, re)
boxplot(m1)
boxplot(m1~re)
boxplot(as.factor(initobs$Observer)~re)
boxplot(Observer~re)
boxplot(Observer~re, data = initobs)
re
# Create plots of random effects
re <- ranef(m1)
re
boxplot(re)
re
# Create plots of random effects
re <- ranef(m1)$Observer
re
coef(m1)
