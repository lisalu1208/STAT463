---
title: "STAT463 Project: Sleep Health and Lifestyle"
author: "Lisa Lu 31088272"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
library(stringr)
```


```{r}
dataset <- read.table("Sleep_health_and_lifestyle_dataset.csv", 
                      header = TRUE, sep = ',', na.strings = "na")

# Split Blood Pressure column into systolic and diastolic pressure
dataset[c('Systolic.Pressure', 'Diastolic.Pressure')] <- as.numeric(str_split_fixed(dataset$Blood.Pressure, '/', 2))

sleep <- dataset[, -10]

summary(dataset)
# Frequency chart
dataset %>% 
  ggplot(aes(x = Stress.Level)) +
  geom_bar() +
  labs(y = "Frequency", x = "Stress Level") 
```


# Explore the factors affecting quality of sleep
```{r}
# Use linear regression model
lr <- lm(Quality.of.Sleep ~ Stress.Level + Heart.Rate + Systolic.Pressure + Diastolic.Pressure, data = sleep)
summary(lr)
plot(lr)

# Use PCA analysis
# Standardise the Quality of sleep and stress level
Quality.of.Sleep <- data.frame(scale(sleep$Quality.of.Sleep))
Stress.Level <- data.frame(scale(sleep$Stress.Level))

pca_dataset <- select(sleep, Stress.Level, Heart.Rate, Daily.Steps, Systolic.Pressure, Diastolic.Pressure)
pca <- prcomp(scale(pca_dataset))
summary(pca)
```


# Explore the causes of sleep disorder