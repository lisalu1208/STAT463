---
title: 'Assignment 4 STAT 315-463:  Multivariable Statistical Methods and Applications'
header-includes:
   - \usepackage{bm}
   - \usepackage{amsmath}
output: 
  pdf_document:
    number_sections: no
---

```{r,warning=FALSE, message=FALSE}
library(here)
library(lattice)
library(lme4)
library(ggplot2)

library(tidyverse)
```



```{r}
# Read in data file
tern14 <- read.table("Terns2014.csv", header = TRUE, sep = ',', na.strings = "na")
summary(tern14)
```

```{r}
# Only using Linear Regression
Model <- lm(Age ~ Wing * ID, data = tern14)
summary(Model)
AIC(Model)
```

## Model 1: Random intercepts

```{r cars}
Model.1 <- lmer(Age ~ Wing + (1|ID), data = tern14)
summary(Model.1)
AIC(Model.1)
```

In Model 1, we are looking at the fixed effect of **Wing** with the random intercepts.
Besides, the AIC value of this mixed linear model indicates that it fits better than the model that ignores individual effects. 
Fixed Effects:
Random Effects: Around 88.4\% of variability is explained by the random intercepts.


```{r}
model1_coefs <- coef(Model.1)$ID %>%
  rename(Intercept = '(Intercept)', Slope = Wing) %>%
  rownames_to_column("ID")

# See coefficients
summary(model1_coefs)

hist(model1_coefs$Intercept)
```

## Model 2: Random slopes

In this case, we are expecting all terns to start off at around the same point, but the effects of wing length on age differs across each tern.

```{r}
Model.2 <- lmer(Age ~ Wing + (0 + Wing|ID), data = tern14)
summary(Model.2)
AIC(Model.2)
```

```{r}
model2_coefs <- coef(Model.2)$ID %>%
  rename(Intercept = '(Intercept)', Slope=Wing) %>%
  rownames_to_column("ID")

summary(model2_coefs)
```

## Model 3: Random slopes and intercepts

```{r}
Model.3 <- lmer(Age ~ Wing + (1 + Wing|ID), data = tern14)
summary(Model.3)
AIC(Model.3)
```

From the AIC result above, we can see that this model with random slopes and random intercepts has the best fit.
```{r}
model3_coefs <- coef(Model.3)$ID %>%
  rename(Intercept = '(Intercept)', Slope=Wing) %>%
  rownames_to_column("ID")

plot(model3_coefs$Intercept, model3_coefs$Slope)
```

